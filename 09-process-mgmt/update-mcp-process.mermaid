flowchart TD
 subgraph SYNC1["üîÑ Full Data Sync Pipeline"]
        S1A["Generate Tool Knowledge ‚Üí MongoDB"]
        S1B["Generate Tool Index ‚Üí Qdrant"]
        S1C["Update Cache ‚Üí Redis"]
  end
 subgraph SYNC2["üîÑ Update Data Sync Pipeline"]
        S2A["Update Metadata ‚Üí MongoDB"]
        S2B["Regenerate Index ‚Üí Qdrant"]
        S2C["Refresh Cache ‚Üí Redis"]
  end
 subgraph CLEANUP["üßπ Cleanup Pipeline"]
        CL1["Remove Index ‚Üí Qdrant"]
        CL2["Clear Cache ‚Üí Redis"]
        CL3["Update Status ‚Üí MongoDB"]
  end
    A1["Admin: Set MCP Server Active"] --> B1{"Server Exists in MongoDB?"}
    A4["Admin: Rename/Move Tools"] --> B4{"Source & Target Servers Exist?"}
    A2["Admin: Set MCP Server Inactive"] --> B2{"Server Currently Active?"}
    A3["Admin: Update Server Metadata"] --> B3{"Server Exists in MongoDB?"}
    A5["Admin: Set Tool as Featured"] --> B5{"Tool Success Rate > 90%?"}
    B1 -- No --> ERR1["Error: Server Not Found"]
    B1 -- Yes --> C1["Update Server Status: ACTIVATING"]
    C1 --> FULLSYNC["Full Data Sync Pipeline"]
    B2 -- No --> ERR2["Error: Server Already Inactive"]
    B2 -- Yes --> C2["Update Server Status: DEACTIVATING"]
    C2 --> CLEANUP
    B3 -- No --> ERR3["Error: Server Not Found"]
    B3 -- Yes --> C3["Update Server Metadata in MongoDB"]
    C3 --> UPDATESYNC["Update Data Sync Pipeline"]
    B4 -- No --> ERR4["Error: Server(s) Not Found"]
    B4 -- Yes --> C4["Update Tool Metadata in MongoDB"]
    C4 --> FULLSYNC
    FULLSYNC --> G4["Update Related Agent Tools"] & SUCCESS1["Server Activated ‚úÖ"]
    G4 --> SUCCESS4["Tools Moved/Renamed ‚úÖ"]
    B5 -- No --> ERR5["Error: Success Rate &lt; 90%"]
    B5 -- Yes --> C5["Update Tool Priority in MongoDB"]
    C5 --> UPDATESYNC
    S1A --> S1B
    S1B --> S1C
    S2A --> S2B
    S2B --> S2C
    CL1 --> CL2
    CL2 --> CL3
    UPDATESYNC --> SUCCESS2["Server Updated ‚úÖ"] & SUCCESS3["Tool Featured ‚úÖ"]
    CLEANUP --> SUCCESS4B["Server Deactivated ‚úÖ"]
    FULLSYNC -. Any Step Fails .-> REVIEW1["‚ö†Ô∏è Review System Health"]
    UPDATESYNC -. Any Step Fails .-> REVIEW1
    CLEANUP -. Any Step Fails .-> REVIEW1
    G4 -. Fails .-> REVIEW2["‚ö†Ô∏è Review Agent Configuration"]
    MONGO[("üóÑÔ∏è MongoDB<br>Single Source of Truth<br>‚Ä¢ Server Status<br>‚Ä¢ Tool Metadata<br>‚Ä¢ Agent Configurations")]
    QDRANT[("üîç Qdrant<br>Vector Database<br>‚Ä¢ Tool Semantic Index<br>‚Ä¢ Search Optimization")]
    REDIS[("‚ö° Redis<br>Cache Layer<br>‚Ä¢ Active Tools<br>‚Ä¢ Featured Tools")]

     A1:::entry
     A4:::entry
     A2:::entry
     A3:::entry
     A5:::entry
     ERR1:::error
     C1:::process
     FULLSYNC:::pipeline
     ERR2:::error
     C2:::process
     CLEANUP:::pipeline
     ERR3:::error
     C3:::process
     UPDATESYNC:::pipeline
     ERR4:::error
     C4:::process
     G4:::process
     SUCCESS1:::success
     SUCCESS4:::success
     ERR5:::error
     C5:::process
     SUCCESS2:::success
     SUCCESS3:::success
     SUCCESS4B:::success
     REVIEW1:::review
     REVIEW2:::review
     MONGO:::storage
     QDRANT:::storage
     REDIS:::storage
    classDef success fill:#c8e6c9,stroke:#4caf50,stroke-width:2px,color:#2e7d32
    classDef error fill:#ffcdd2,stroke:#f44336,stroke-width:2px,color:#c62828
    classDef process fill:#e3f2fd,stroke:#2196f3,stroke-width:2px,color:#1565c0
    classDef review fill:#fff3e0,stroke:#ff9800,stroke-width:2px,color:#ef6c00
    classDef storage fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px,color:#7b1fa2
    classDef entry fill:#e8f5e8,stroke:#4caf50,stroke-width:3px,color:#2e7d32
    classDef pipeline fill:#f0f4ff,stroke:#3f51b5,stroke-width:2px,color:#303f9f


